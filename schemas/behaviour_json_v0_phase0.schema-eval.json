{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/Standivarius/Aigov-eval/schemas/behaviour_json_v0_phase0.schema-eval.json",
  "title": "Behaviour JSON v0 Phase 0",
  "description": "Schema for judge output in behaviour_json_v0_phase0 format. This is the canonical contract for judge outputs in Phase 0.",
  "type": "object",
  "required": [
    "audit_id",
    "run_id",
    "finding_id",
    "scenario_id",
    "framework",
    "rating",
    "reasoning",
    "inspect_provenance"
  ],
  "properties": {
    "audit_id": {
      "type": "string",
      "description": "Unique identifier for the audit session",
      "pattern": "^[a-zA-Z0-9_-]+$"
    },
    "run_id": {
      "type": "string",
      "description": "Unique identifier for this specific run",
      "pattern": "^[a-zA-Z0-9_-]+$"
    },
    "finding_id": {
      "type": "string",
      "description": "Unique identifier for this finding",
      "pattern": "^[a-zA-Z0-9_-]+$"
    },
    "scenario_id": {
      "type": "string",
      "description": "Identifier of the scenario being evaluated"
    },
    "framework": {
      "type": "string",
      "description": "Compliance framework (e.g., GDPR, HIPAA)",
      "enum": ["GDPR", "HIPAA", "CCPA", "SOC2", "ISO27001"]
    },
    "rating": {
      "type": "string",
      "description": "Overall compliance rating",
      "enum": ["VIOLATED", "COMPLIANT", "UNDECIDED"]
    },
    "reasoning": {
      "type": "array",
      "description": "List of reasoning statements explaining the rating",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "legal_references": {
      "type": "array",
      "description": "Legal citations and article references",
      "items": {
        "type": "string"
      }
    },
    "signals": {
      "type": "array",
      "description": "List of detected compliance signals",
      "items": {
        "type": "string"
      }
    },
    "severity": {
      "type": "string",
      "description": "Severity level of the finding",
      "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW", "INFO"]
    },
    "inspect_provenance": {
      "type": "object",
      "description": "Provenance metadata about the inspection/judge process",
      "required": ["model", "timestamp_utc"],
      "properties": {
        "model": {
          "type": "string",
          "description": "Model or judge version used"
        },
        "temperature": {
          "type": "number",
          "description": "Temperature parameter used (if applicable)",
          "minimum": 0,
          "maximum": 2
        },
        "mock": {
          "type": "boolean",
          "description": "Whether this was a mock/offline judge run"
        },
        "timestamp_utc": {
          "type": "string",
          "description": "ISO 8601 timestamp of when the judgment was made",
          "format": "date-time"
        },
        "source_fixture": {
          "type": "string",
          "description": "Source fixture file (for offline judge)"
        }
      },
      "additionalProperties": true
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
